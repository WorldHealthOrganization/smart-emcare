{
    "resourceType": "Library",
    "id": "chezscore",
    "url": "https://fhir.dk.swisstph-mis.ch/matchbox/fhir//Library/chezscore",
    "identifier": [
        {
            "use": "official",
            "value": "CHEZScore"
        }
    ],
    "version": "1.0.239+build.382",
    "name": "chezscore",
    "title": "CHE.Z.Score",
    "status": "active",
    "type": {
        "coding": [
            {
                "system": "http://hl7.org/fhir/ValueSet/library-type",
                "code": "logic-library"
            }
        ]
    },
    "relatedArtifact": [
        {
            "type": "depends-on",
            "resource": "http://fhir.org/guides/who/anc-cds/Library/FHIRHelpers"
        },
        {
            "type": "depends-on",
            "resource": "https://fhir.dk.swisstph-mis.ch/matchbox/fhir/Library/chebase"
        },
        {
            "type": "depends-on",
            "resource": "https://fhir.dk.swisstph-mis.ch/matchbox/fhir/Library/weightforage"
        },
        {
            "type": "depends-on",
            "resource": "https://fhir.dk.swisstph-mis.ch/matchbox/fhir/Library/anthrobase"
        },
        {
            "type": "depends-on",
            "resource": "https://fhir.dk.swisstph-mis.ch/matchbox/fhir/Library/weightforlength"
        },
        {
            "type": "depends-on",
            "resource": "https://fhir.dk.swisstph-mis.ch/matchbox/fhir/Library/weightforheight"
        }
    ],
    "parameter": [
        {
            "name": "encounter",
            "use": "in",
            "type": "Encounter"
        },
        {
            "name": "pastweight",
            "use": "out",
            "type": "decimal"
        },
        {
            "name": "patientsex",
            "use": "out",
            "type": "string"
        },
        {
            "name": "ageatpastweight",
            "use": "out",
            "type": "integer"
        },
        {
            "name": "pastweightzscore",
            "use": "out",
            "type": "decimal"
        },
        {
            "name": "pastweightactualised",
            "use": "out",
            "type": "decimal"
        },
        {
            "name": "WAZ",
            "use": "out",
            "type": "decimal"
        }
    ],
    "dataRequirement": [
        {
            "type": "Patient",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Patient"
            ]
        },
        {
            "type": "Encounter",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Encounter"
            ]
        },
        {
            "type": "Observation",
            "profile": [
                "http://hl7.org/fhir/StructureDefinition/Observation"
            ],
            "mustSupport": [
                "code",
                "encounter.reference",
                "encounter",
                "value",
                "status"
            ],
            "codeFilter": [
                {
                    "path": "code",
                    "code": [
                        {
                            "code": "CHE.B6.DE06"
                        }
                    ]
                }
            ]
        }
    ],
    "content": [
        {
            "id": "ig-loader-chezscore.cql",
            "contentType": "text/cql",
            "data": "LyoKQGF1dGhvcjogUGF0cmljayBEZWxjcm9peApAZGVzY3JpcHRpb246IFRoaXMgbGlicmFyeSBpcyBwYXJ0IG9mIHRoZSBwcm9qZWN0IENIRQoqLwpsaWJyYXJ5IGNoZXpzY29yZSB2ZXJzaW9uICcxLjAuMjM5K2J1aWxkLjM4MicKdXNpbmcgRkhJUiB2ZXJzaW9uICc0LjAuMScKaW5jbHVkZSBGSElSSGVscGVycyB2ZXJzaW9uICc0LjAuMScgY2FsbGVkIEZISVJIZWxwZXJzIAppbmNsdWRlIGNoZWJhc2UgdmVyc2lvbiAnMS4wLjIzOStidWlsZC4zODInIGNhbGxlZCBCYXNlCmluY2x1ZGUgV2VpZ2h0Rm9yQWdlIHZlcnNpb24gJzEuMC40JyBjYWxsZWQgd2ZhCmluY2x1ZGUgV2VpZ2h0Rm9yTGVuZ3RoIHZlcnNpb24gJzEuMC40JyBjYWxsZWQgd2ZsCmluY2x1ZGUgV2VpZ2h0Rm9ySGVpZ2h0IHZlcnNpb24gJzEuMC40JyBjYWxsZWQgd2ZoCgoKCi8vY29kZXN5c3RlbSAiQ0hFIiA6ICdodHRwczovL2ZoaXIuZGsuc3dpc3N0cGgtbWlzLmNoL21hdGNoYm94L2ZoaXIvQ29kZVN5c3RlbS9jaGUtY3VzdG9tLWNvZGVzJwoKCgovL2NvZGUgIldlaWdodCI6ICdDSEUuQjYuREUwNicgZnJvbSAiQ0hFIiBkaXNwbGF5ICdXZWlnaHQnCi8vY29kZSAiRXN0aW1hdGVkIFdlaWdodCI6ICdDSEUuQjYuREUwOCcgZnJvbSAiQ0hFIiBkaXNwbGF5ICdFc3RpbWF0ZWQgV2VpZ2h0JwovL2NvZGUgIk1VQUMiOiAnQ0hFLkI2LkRFMTcnIGZyb20gIkNIRSIgZGlzcGxheSAnTVVBQycKLy9jb2RlICJMZW5ndGgiOiAnQ0hFLkI2LkRFMTInIGZyb20gIkNIRSIgZGlzcGxheSAnTGVuZ3RoJwovL2NvZGUgIkhlaWdodCI6ICdDSEUuQjYuREUwOScgZnJvbSAiQ0hFIiBkaXNwbGF5ICdIZWlnaHQnCgpwYXJhbWV0ZXIgImVuY291bnRlcmlkIiBTdHJpbmcKCmNvbnRleHQgUGF0aWVudAoKZGVmaW5lICJXZWlnaHQiOgogIEJhc2UuY29kaW5nKCdDSEUuQjYuREUwNicpCmRlZmluZSAiRXN0aW1hdGVkIFdlaWdodCI6CiAgQmFzZS5jb2RpbmcoJ0NIRS5CNi5ERTA4JykKZGVmaW5lICJNVUFDIjoKICBCYXNlLmNvZGluZygnQ0hFLkI2LkRFMTcnKQpkZWZpbmUgIkxlbmd0aCI6CiAgQmFzZS5jb2RpbmcoJ0NIRS5CNi5ERTEyJykKZGVmaW5lICJIZWlnaHQiOgogIEJhc2UuY29kaW5nKCdDSEUuQjYuREUwOScpCmRlZmluZSAiVmlzdWFsbHkgYXNzZXNzIjoKICBCYXNlLmNvZGluZygnQ0hFLkI2LkRFMTgnKQpkZWZpbmUgIlVuZGVyd2VpZ2h0IjoKICBCYXNlLmNvZGluZygnQ0hFLkI2LkRFMjAnKSAKZGVmaW5lICJTZXZlcmVseSBVbmRlcndlaWdodCI6CiAgQmFzZS5jb2RpbmcoJ0NIRS5CNi5ERTIxJykgCgovKiBwYXN0d2VpZ2h0IDogUHJldmlvdXMgV2VpZ2h0Ki8KZGVmaW5lICJwYXN0d2VpZ2h0b2JzIjoKICAgIGlmIEFnZUluTW9udGhzKCk8IDQgIHRoZW4KICAgICAgQmFzZS5HZXRIaXN0b3JpY09ic2VydmF0aW9uKCJXZWlnaHQiLCA2MCkKICAgIGVsc2UgaWYgQWdlSW5Nb250aHMoKTwgNiAgdGhlbgogICAgICBCYXNlLkdldEhpc3RvcmljT2JzZXJ2YXRpb24oIldlaWdodCIsIDkxKQogICAgZWxzZSBpZiBBZ2VJbk1vbnRocygpPCAxMiAgdGhlbgogICAgICBCYXNlLkdldEhpc3RvcmljT2JzZXJ2YXRpb24oIldlaWdodCIsIDEyMSkKICAgIGVsc2UgCiAgICAgIEJhc2UuR2V0SGlzdG9yaWNPYnNlcnZhdGlvbigiV2VpZ2h0IiwgMTgwKQoKZGVmaW5lICJwYXN0d2VpZ2h0IjoKICAgIGlmICJwYXN0d2VpZ2h0b2JzIiBpcyBub3QgbnVsbCB0aGVuCiAgICAgICJwYXN0d2VpZ2h0b2JzIi52YWx1ZQogICAgZWxzZSBudWxsCgovKiBwYXRpZW50c2V4IDogUGF0aWVudCBzZXgqLwpkZWZpbmUgInBhdGllbnRzZXgiOgogICAgaWYgUGF0aWVudC5nZW5kZXIgPSAnZmVtYWxlJyB0aGVuICdmZW1hbGUnIGVsc2UgJ21hbGUnCgovKiBhZ2VhdHBhc3R3ZWlnaHQgOiBBZ2UgYXQgUHJldmlvdXMgV2VpZ2h0Ki8KZGVmaW5lICJhZ2VhdHBhc3R3ZWlnaHQiOgogICAgaWYgInBhc3R3ZWlnaHQiIGlzIG5vdCBudWxsICB0aGVuCiAgICAgICAgKGRpZmZlcmVuY2UgaW4gZGF5cyBiZXR3ZWVuIFBhdGllbnQuYmlydGhEYXRlIGFuZCBUb0RhdGUocGFzdHdlaWdodG9icy5pc3N1ZWQpKSAqICggMS4wIGFzIFN5c3RlbS5EZWNpbWFsICkKICAgIGVsc2UKICAgICBudWxsCgovKiBwYXN0d2VpZ2h0enNjb3JlIDogWi1TY29yZSBhdCBQcmV2aW91cyBXZWlnaHQqLwpkZWZpbmUgInBhc3R3ZWlnaHR6c2NvcmUiOgogICAgaWYgInBhc3R3ZWlnaHQiIGlzIG5vdCBudWxsICB0aGVuCiAgICAgIHdmYS5nZW5lcmF0ZVpTY29yZVdlaWdodEZvckFnZSgicGF0aWVudHNleCIsICJhZ2VhdHBhc3R3ZWlnaHQiICwgKCJwYXN0d2VpZ2h0Ii52YWx1ZSAqICggMS4wIGFzIFN5c3RlbS5EZWNpbWFsKSkpCiAgICBlbHNlCiAgICAgIG51bGwKCi8qIHBhc3R3ZWlnaHRhY3R1YWxpc2VkIDogV2VpZ2h0IGZyb20gIGF0IFByZXZpb3VzIFdlaWdodCovCmRlZmluZSAicGFzdHdlaWdodGFjdHVhbGlzZWQiOgogICAgaWYgInBhc3R3ZWlnaHR6c2NvcmUiIGlzIG5vdCBudWxsIHRoZW4KICAgICAgU3lzdGVtLlF1YW50aXR5IHsgdmFsdWU6IFJvdW5kKHdmYS5nZW5lcmF0ZVdlaWdodEZyb21BZ2UoInBhdGllbnRzZXgiLEFnZUluRGF5cygpICogKCAxLjAgYXMgU3lzdGVtLkRlY2ltYWwgKSwgICJwYXN0d2VpZ2h0enNjb3JlIiApLDIpLCB1bml0OiAna2cnfSAKICAgIGVsc2UgCiAgICAgICBudWxsCgoKCmRlZmluZSBleGlzdGluZ3dlaWdodDoKICBCYXNlLkdldE9ic1ZhbHVlKCJXZWlnaHQiKQoKZGVmaW5lIGV4aXN0aW5nZXN0aW1uYXRlZHdlaWdodDoKICBpZiBleGlzdGluZ3dlaWdodCBpcyBudWxsIHRoZW4gIAogICAgQmFzZS5HZXRPYnNWYWx1ZSgiRXN0aW1hdGVkIFdlaWdodCIpCiAgZWxzZSAKICAgIG51bGwKCmRlZmluZSBleGlzdGluZ2hlaWdodDoKICBCYXNlLkdldE9ic1ZhbHVlKCJIZWlnaHQiKQoKZGVmaW5lIGV4aXN0aW5nbGVuZ3RoOgogIEJhc2UuR2V0T2JzVmFsdWUoIkxlbmd0aCIpCgpkZWZpbmUgZXhpc3RpbmdtdWFjOgogIEJhc2UuR2V0T2JzVmFsdWUoIk1VQUMiKQoKZGVmaW5lIGV4aXN0aW5ndmlzdWFsOgogIEJhc2UuR2V0T2JzVmFsdWUoIlZpc3VhbGx5IGFzc2VzcyIpCi8vCmRlZmluZSB6c2NvcmVmcm9tbXVhYzoKICBpZiBleGlzdGluZ211YWMgaXMgbnVsbCB0aGVuIG51bGwKICBlbHNlIGlmIGV4aXN0aW5nbXVhYyA8IDExNSAnbW5tJyB0aGVuIC0zLjAKICBlbHNlIGlmIGV4aXN0aW5nbXVhYyA8IDEyNSAnbW5tJyB0aGVuIC0yLjAKICBlbHNlIDAuMAoKZGVmaW5lIGVzdGltYXRlZHdlaWdodDoKICBjYXNlICAKICB3aGVuIGV4aXN0aW5nd2VpZ2h0IGlzIG5vdCBudWxsIHRoZW4gbnVsbAogIHdoZW4gZXhpc3Rpbmdlc3RpbW5hdGVkd2VpZ2h0IGlzIG5vdCBudWxsIHRoZW4gZXhpc3Rpbmdlc3RpbW5hdGVkd2VpZ2h0CiAgd2hlbiBwYXN0d2VpZ2h0YWN0dWFsaXNlZCBpcyBub3QgbnVsbCB0aGVuIHBhc3R3ZWlnaHRhY3R1YWxpc2VkCiAgd2hlbiBBZ2VJbk1vbnRocygpPjI0IGFuZCBleGlzdGluZ2hlaWdodCB0aGVuIHdlaWdodGZyb21oZWlnaHQKICB3aGVuIEFnZUluTW9udGhzKCk8PTI0IGFuZCBleGlzdGluZ2xlbmd0aCB0aGVuIHdlaWdodGZyb21sZW5ndGgKICBlbHNlIHdlaWdodGZyb21hZ2UKICBlbmQKCmRlZmluZSB6c2NvcmVmcm9tdmlzdWFsOgogICAgaWYgZXhpc3Rpbmd2aXN1YWwgaXMgbm90IG51bGwgdGhlbgogICAgICBjYXNlICAKICAgICAgICB3aGVuIGV4aXN0aW5ndmlzdWFsIH4gIlNldmVyZWx5IFVuZGVyd2VpZ2h0IiB0aGVuIC0zLjAKICAgICAgICB3aGVuIGV4aXN0aW5ndmlzdWFsIH4gIlVuZGVyd2VpZ2h0IiB0aGVuIC0yLjAKICAgICAgICBlbHNlIDAuMAogICAgICBlbmQKICAgIGVsc2UgIG51bGwKCgpkZWZpbmUgd2VpZ2h0ZnJvbWxlbmd0aDoKICAgIFN5c3RlbS5RdWFudGl0eSB7IHZhbHVlOiBSb3VuZCh3ZmwuZ2VuZXJhdGVXZWlnaHRGcm9tTGVuZ3RoKCJwYXRpZW50c2V4IiwoY29udmVydCBleGlzdGluZ2xlbmd0aCB0byAnY20nKS52YWx1ZSAqICggMS4wIGFzIFN5c3RlbS5EZWNpbWFsICksIHpzY29yZWZyb21tdWFjKSwyKSwgdW5pdDogJ2tnJ30KCmRlZmluZSB3ZWlnaHRmcm9taGVpZ2h0OgogICAgU3lzdGVtLlF1YW50aXR5IHsgdmFsdWU6Um91bmQod2ZoLmdlbmVyYXRlV2VpZ2h0RnJvbUhlaWdodCgicGF0aWVudHNleCIsKGNvbnZlcnQgZXhpc3RpbmdoZWlnaHQgdG8gJ2NtJykudmFsdWUgKiAoIDEuMCBhcyBTeXN0ZW0uRGVjaW1hbCApLCB6c2NvcmVmcm9tbXVhYyksMiksIHVuaXQ6ICdrZyd9CgpkZWZpbmUgd2VpZ2h0ZnJvbWFnZToKICAgIFN5c3RlbS5RdWFudGl0eSB7IHZhbHVlOlJvdW5kKHdmYS5nZW5lcmF0ZVdlaWdodEZyb21BZ2UoInBhdGllbnRzZXgiLEFnZUluRGF5cygpICogKCAxLjAgYXMgU3lzdGVtLkRlY2ltYWwgKSwgenNjb3JlZnJvbW11YWMpLDIpLCB1bml0OiAna2cnfQovKgooY29udmVydCBCYXNlLkhhc09icygiV2VpZ2h0IikgdG8gJ0tnJykgZG9lcyBub3Qgd29yaywgc28gbGV0J3MgYXNzdW1lIHRoZSB3ZWlnaHQgaXMgaW4gS2cKKi8KZGVmaW5lICJXQVoiOgogICAgaWYgZXhpc3Rpbmd3ZWlnaHQgaXMgbm90IG51bGwgdGhlbgogICAgICAgICB3ZmEuZ2VuZXJhdGVaU2NvcmVXZWlnaHRGb3JBZ2UoInBhdGllbnRzZXgiLCBBZ2VJbkRheXMoKSAsIChleGlzdGluZ3dlaWdodC52YWx1ZSAqICggMS4wIGFzIFN5c3RlbS5EZWNpbWFsICkpKQogICAgZWxzZSBpZiBleGlzdGluZ211YWMgaXMgbm90IG51bGwgdGhlbgogICAgICAgIHpzY29yZWZyb21tdWFjCiAgICBlbHNlIGlmIGV4aXN0aW5ndmlzdWFsIHRoZW4KICAgICAgICB6c2NvcmVmcm9tdmlzdWFsCiAgICBlbHNlIG51bGwKCmRlZmluZSAiV0xaIjoKICAgIGlmIGV4aXN0aW5nd2VpZ2h0IGlzIG5vdCBudWxsIHRoZW4KICAgICAgICAgd2ZsLmdlbmVyYXRlWlNjb3JlV2VpZ2h0Rm9yTGVuZ3RoKCJwYXRpZW50c2V4IiwgKGV4aXN0aW5nbGVuZ3RoLnZhbHVlICogKCAxLjAgYXMgU3lzdGVtLkRlY2ltYWwgKSkgLCAgKGV4aXN0aW5nd2VpZ2h0LnZhbHVlICogKCAxLjAgYXMgU3lzdGVtLkRlY2ltYWwgKSkpCiAgICBlbHNlIGlmIGV4aXN0aW5nbXVhYyBpcyBub3QgbnVsbCB0aGVuCiAgICAgICAgenNjb3JlZnJvbW11YWMKICAgIGVsc2UgaWYgZXhpc3Rpbmd2aXN1YWwgdGhlbgogICAgICAgIHpzY29yZWZyb212aXN1YWwKICAgIGVsc2UgbnVsbAoKZGVmaW5lICJXSFoiOgogICAgaWYgZXhpc3Rpbmd3ZWlnaHQgaXMgbm90IG51bGwgdGhlbgogICAgICAgICB3ZmguZ2VuZXJhdGVaU2NvcmVXZWlnaHRGb3JIZWlnaHQoInBhdGllbnRzZXgiLCAoZXhpc3RpbmdoZWlnaHQudmFsdWUgKiAoIDEuMCBhcyBTeXN0ZW0uRGVjaW1hbCApKSAsICAoZXhpc3Rpbmd3ZWlnaHQudmFsdWUgKiAoIDEuMCBhcyBTeXN0ZW0uRGVjaW1hbCApKSkKICAgIGVsc2UgaWYgZXhpc3RpbmdtdWFjIGlzIG5vdCBudWxsIHRoZW4KICAgICAgICB6c2NvcmVmcm9tbXVhYwogICAgZWxzZSBpZiBleGlzdGluZ3Zpc3VhbCB0aGVuCiAgICAgICAgenNjb3JlZnJvbXZpc3VhbAogICAgZWxzZSBudWxsCg=="
        }
    ]
}